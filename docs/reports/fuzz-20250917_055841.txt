Warning: This is a nightly build of Foundry. It is recommended to use the latest stable version. Visit https://book.getfoundry.sh/announcements for more information.
To mute this warning set `FOUNDRY_DISABLE_NIGHTLY_WARNING` in your environment.

No files changed, compilation skipped

Ran 14 tests for test/B3VirtualPairTest.sol:B3VirtualPairTest
[PASS] testKConsistencyAfterVirtualPairUpdates() (gas: 22674)
[PASS] testKConstantCalculation() (gas: 10917)
[PASS] testVirtualInputTokensInitialization() (gas: 7849)
[PASS] testVirtualLInitialization() (gas: 14030)
[PASS] testVirtualLNotEqualTotalSupply() (gas: 19209)
[PASS] testVirtualPairArchitectureDocumentation() (gas: 23144)
[PASS] testVirtualPairConsistency() (gas: 25128)
[PASS] testVirtualPairIndependentFromActualBalances() (gas: 139989)
[PASS] testVirtualPairInitialization() (gas: 24014)
[PASS] testVirtualPairInitializationFlag() (gas: 12149)
[PASS] testVirtualPairNotStandardBondingCurve() (gas: 15193)
[PASS] testVirtualPairPreservesKAfterOperations() (gas: 197514)
[PASS] testVirtualPairStateAfterBondingTokenMinting() (gas: 66689)
[PASS] testVirtualPairWithZeroValues() (gas: 10325)
Suite result: ok. 14 passed; 0 failed; 0 skipped; finished in 2.20ms (1.19ms CPU time)

Ran 15 tests for test/B3AddLiquidityTest.sol:B3AddLiquidityTest
[PASS] testAddLiquidityBasic() (gas: 198306)
[PASS] testAddLiquidityEvent() (gas: 199323)
[PASS] testAddLiquidityInsufficientApproval() (gas: 67035)
[PASS] testAddLiquidityInsufficientBalance() (gas: 69676)
[PASS] testAddLiquidityLargeAmount() (gas: 202432)
[PASS] testAddLiquidityMEVProtection() (gas: 65306)
[PASS] testAddLiquidityMEVProtectionPasses() (gas: 197339)
[PASS] testAddLiquidityMultipleUsers() (gas: 269446)
[PASS] testAddLiquidityPreservesK() (gas: 201482)
[PASS] testAddLiquidityReentrancyProtection() (gas: 194998)
[PASS] testAddLiquidityVaultDeposit() (gas: 200179)
[PASS] testAddLiquidityVirtualPairMath() (gas: 197223)
[PASS] testAddLiquidityVirtualPairUpdate() (gas: 198539)
[PASS] testAddLiquidityWithDifferentAmounts() (gas: 363157)
[PASS] testAddLiquidityZeroAmount() (gas: 19495)
Suite result: ok. 15 passed; 0 failed; 0 skipped; finished in 6.10ms (3.74ms CPU time)

Ran 20 tests for test/AutoDolaVaultIntegration.t.sol:AutoDolaVaultIntegration
[SKIP] test_AutoDolaCompound_GasBenchmark_PlaceholderForFuture() (gas: 0)
[SKIP] test_AutoDolaHarvest_GasBenchmark_PlaceholderForFuture() (gas: 0)
[PASS] test_ComprehensiveGasAnalysis() (gas: 663925)
Logs:
  === GAS BENCHMARK RESULTS ===
  Operation | Test Case | Amount | Gas Used
  ----------------------------------------
  DEPOSIT | small_analysis | 1000000000000000 | 81944
  DEPOSIT | medium_analysis | 1000000000000000000 | 69439
  WITHDRAW | medium_analysis | 1000000000000000000 | 6374
  INTEGRATED_DEPOSIT | analysis | 1000000000000000000 | 197035
  ==========================================
  Average Deposit Gas: 75691
  Average Withdraw Gas: 6374

[PASS] test_IntegratedDeposit_via_AddLiquidity_GasBenchmark() (gas: 309586)
[PASS] test_IntegratedWithdraw_via_RemoveLiquidity_GasBenchmark() (gas: 297381)
[PASS] test_MultipleUsers_Deposit_GasBenchmark() (gas: 309043)
[PASS] test_VaultDeposit_LargeAmount_GasBenchmark() (gas: 208641)
[PASS] test_VaultDeposit_MaxAmount_GasBenchmark() (gas: 218297)
[PASS] test_VaultDeposit_MediumAmount_GasBenchmark() (gas: 208728)
[PASS] test_VaultDeposit_SmallAmount_GasBenchmark() (gas: 208683)
[PASS] test_VaultDeposit_Unauthorized_ShouldRevert() (gas: 1167318)
[PASS] test_VaultDeposit_ZeroAddressRecipient_ShouldRevert() (gas: 41247)
[PASS] test_VaultDeposit_ZeroAddressToken_ShouldRevert() (gas: 11062)
[PASS] test_VaultDeposit_ZeroAmount_ShouldRevert() (gas: 21266)
[PASS] test_VaultWithdraw_InsufficientBalance_ShouldRevert() (gas: 15514)
[PASS] test_VaultWithdraw_LargeAmount_GasBenchmark() (gas: 184584)
[PASS] test_VaultWithdraw_MediumAmount_GasBenchmark() (gas: 184514)
[PASS] test_VaultWithdraw_SmallAmount_GasBenchmark() (gas: 185448)
[PASS] test_VaultWithdraw_Unauthorized_ShouldRevert() (gas: 1139481)
[PASS] test_VaultWithdraw_ZeroAmount_ShouldRevert() (gas: 13177)
Suite result: ok. 18 passed; 0 failed; 2 skipped; finished in 7.59ms (5.54ms CPU time)

Ran 22 tests for test/B3QuoteFunctionsTest.sol:B3QuoteFunctionsTest
[PASS] testMultipleQuoteCallsConsistent() (gas: 21481)
[PASS] testQuoteAddLiquidityBasic() (gas: 17035)
[PASS] testQuoteAddLiquidityConsistentWithActual() (gas: 197198)
[PASS] testQuoteAddLiquidityDifferentAmounts() (gas: 27587)
[PASS] testQuoteAddLiquidityLargeAmount() (gas: 18677)
[PASS] testQuoteAddLiquidityMath() (gas: 24982)
[PASS] testQuoteAddLiquidityMaxInput() (gas: 16658)
[PASS] testQuoteAddLiquidityPrecision() (gas: 17094)
[PASS] testQuoteAddLiquiditySmallAmount() (gas: 16969)
[PASS] testQuoteAddLiquidityZeroInput() (gas: 5714)
[PASS] testQuoteAfterStateChanges() (gas: 199377)
[PASS] testQuoteRemoveLiquidityBasic() (gas: 17042)
[PASS] testQuoteRemoveLiquidityConsistentWithActual() (gas: 224112)
[PASS] testQuoteRemoveLiquidityDifferentAmounts() (gas: 27549)
[PASS] testQuoteRemoveLiquidityLargeAmount() (gas: 18674)
[PASS] testQuoteRemoveLiquidityMath() (gas: 24935)
[PASS] testQuoteRemoveLiquidityMaxBonding() (gas: 16567)
[PASS] testQuoteRemoveLiquidityPrecision() (gas: 17059)
[PASS] testQuoteRemoveLiquiditySmallAmount() (gas: 17065)
[PASS] testQuoteRemoveLiquidityZeroInput() (gas: 5680)
[PASS] testQuoteSymmetryAddRemove() (gas: 19342)
[PASS] testQuotesDoNotChangeState() (gas: 85226)
Suite result: ok. 22 passed; 0 failed; 0 skipped; finished in 7.55ms (6.39ms CPU time)

Ran 23 tests for test/EarlySellPenaltyHookIntegrationTest.sol:EarlySellPenaltyHookIntegrationTest
[PASS] test_BuyerTimestampRecordedEventEmitted() (gas: 248671)
[PASS] test_BuyerTimestampRecordedOnPurchase() (gas: 249397)
[PASS] test_CompleteScenario_BuyWaitSellWithPenalty() (gas: 269783)
[PASS] test_CustomPenaltyRateWorks() (gas: 270455)
[PASS] test_DifferentBuyersHaveDifferentTimestamps() (gas: 330493)
[PASS] test_FirstTimeBuyerHasZeroTimestamp() (gas: 10096)
[PASS] test_FirstTimeSellWithoutBuyHasMaxPenalty() (gas: 47011)
[PASS] test_ImmediateSellHasMaximumPenalty() (gas: 241375)
[PASS] test_MultipleBuysSingleSell() (gas: 286037)
[PASS] test_NoPenaltyAfter100Hours() (gas: 259018)
[PASS] test_OnlyOwnerCanSetPenaltyParameters() (gas: 33502)
[PASS] test_OnlyOwnerCanTogglePenaltyStatus() (gas: 25180)
[PASS] test_PenaltyAppliedEventEmitted() (gas: 265071)
[PASS] test_PenaltyAtExactHourBoundaries() (gas: 259357)
[PASS] test_PenaltyCanBeDeactivated() (gas: 261579)
[PASS] test_PenaltyDeclinesOverTime() (gas: 259787)
[PASS] test_PenaltyHookIntegratesWithBehodler3() (gas: 241784)
[PASS] test_PenaltyParametersCanBeSet() (gas: 27720)
[PASS] test_PenaltyParametersUpdatedEventEmitted() (gas: 25992)
[PASS] test_PenaltyParametersValidation() (gas: 21427)
[PASS] test_PenaltyStatusChangedEventEmitted() (gas: 15433)
[PASS] test_TimestampUpdatedOnSubsequentBuy() (gas: 277584)
[PASS] test_ZeroAmountBuyDoesNotUpdateTimestamp() (gas: 55931)
Suite result: ok. 23 passed; 0 failed; 0 skipped; finished in 9.33ms (6.31ms CPU time)

Ran 17 tests for test/B3RemoveLiquidityTest.sol:B3RemoveLiquidityTest
[PASS] testAddThenRemoveLiquidity() (gas: 2554445)
[PASS] testRemoveAllLiquidity() (gas: 97651)
[PASS] testRemoveLiquidityBasic() (gas: 104804)
[PASS] testRemoveLiquidityBurnsBondingTokens() (gas: 104586)
[PASS] testRemoveLiquidityEvent() (gas: 104526)
[PASS] testRemoveLiquidityInsufficientBondingTokens() (gas: 27036)
[PASS] testRemoveLiquidityInsufficientVaultBalance() (gas: 98200)
[PASS] testRemoveLiquidityMEVProtection() (gas: 40605)
[PASS] testRemoveLiquidityMEVProtectionPasses() (gas: 102583)
[PASS] testRemoveLiquidityMultipleUsers() (gas: 158297)
[PASS] testRemoveLiquidityPreservesK() (gas: 2591140)
[PASS] testRemoveLiquidityReentrancyProtection() (gas: 100314)
[PASS] testRemoveLiquidityVaultWithdrawal() (gas: 107384)
[PASS] testRemoveLiquidityVirtualPairMath() (gas: 104031)
[PASS] testRemoveLiquidityVirtualPairUpdate() (gas: 103708)
[PASS] testRemoveLiquidityWithDifferentAmounts() (gas: 10216248)
[PASS] testRemoveLiquidityZeroAmount() (gas: 19485)
Suite result: ok. 17 passed; 0 failed; 0 skipped; finished in 9.37ms (7.85ms CPU time)

Ran 25 tests for test/B3SecurityIntegrationTest.sol:B3SecurityIntegrationTest
[PASS] testAddLiquidityReentrancyProtection() (gas: 195000)
[PASS] testAutoLockInitialization() (gas: 7824)
[PASS] testAutoLockTriggersOnCondition() (gas: 220900)
[PASS] testCompleteUserFlow() (gas: 229142)
[PASS] testGasUsageAddLiquidity() (gas: 195185)
[PASS] testGasUsageRemoveLiquidity() (gas: 221867)
[PASS] testInvariantVirtualPairIntegrity() (gas: 356572)
[PASS] testLockEmitsEvent() (gas: 20118)
[PASS] testLockPreventsAddLiquidity() (gas: 58990)
[PASS] testLockPreventsRemoveLiquidity() (gas: 210757)
[PASS] testMultipleUsersInteraction() (gas: 339323)
[PASS] testMultipleVaultChanges() (gas: 2285495)
[PASS] testOverflowProtection() (gas: 72520)
[PASS] testRemoveLiquidityReentrancyProtection() (gas: 221774)
[PASS] testSetAutoLockChangesState() (gas: 26730)
[PASS] testSetVaultBlocksOperationsUntilReinitialized() (gas: 1485002)
[PASS] testSetVaultChangesVaultAddress() (gas: 1150106)
[PASS] testSetVaultEmitsVaultChangedEvent() (gas: 1148624)
[PASS] testSetVaultOnlyOwnerCanCall() (gas: 1151934)
[PASS] testSetVaultResetsVaultApprovalInitialized() (gas: 1147754)
[PASS] testSetVaultWithZeroAddressReverts() (gas: 16168)
[PASS] testUnlockAllowsOperations() (gas: 203802)
[PASS] testUnlockEmitsEvent() (gas: 19226)
[PASS] testVaultFailureHandling() (gas: 195073)
[PASS] testZeroAddressProtection() (gas: 4457485)
Suite result: ok. 25 passed; 0 failed; 0 skipped; finished in 9.32ms (7.82ms CPU time)

Ran 21 tests for test/B3PermitTest.sol:B3PermitTest
[PASS] test_AddLiquidityWithPermit_FailsWithoutPermitOrAllowance() (gas: 85780)
[PASS] test_AddLiquidityWithPermit_FallsBackToAllowance() (gas: 256102)
[PASS] test_AddLiquidityWithPermit_ValidSignature() (gas: 257372)
[PASS] test_DomainSeparator_Consistency() (gas: 6655)
[PASS] test_GasOptimization_PermitVsApprove() (gas: 254331)
[PASS] test_IndependentNoncesForMultipleUsers() (gas: 184523)
[PASS] test_NonceIncrementsCorrectly() (gas: 100455)
[PASS] test_PermitBasic_WithValidSignature() (gas: 104976)
[PASS] test_PermitFails_WithExpiredDeadline() (gas: 21387)
[PASS] test_PermitFails_WithInvalidSignature() (gas: 71712)
[PASS] test_PermitFails_WithNonPermitToken() (gas: 2511373)
[PASS] test_PermitFails_WithWrongNonce() (gas: 71700)
[PASS] test_PermitFails_WithZeroOwner() (gas: 9202)
[PASS] test_PermitFails_WithZeroSpender() (gas: 11437)
[PASS] test_ReplayAttackPrevention() (gas: 106301)
[PASS] test_SecurityTest_SignatureDeadlineMismatch() (gas: 71743)
[PASS] test_SecurityTest_SignatureSpenderMismatch() (gas: 73611)
[PASS] test_SecurityTest_SignatureValueMismatch() (gas: 71690)
[PASS] test_SupportsInterface_EIP165() (gas: 5804)
[PASS] test_SupportsInterface_IERC20Permit() (gas: 5837)
[PASS] test_SupportsInterface_UnsupportedInterface() (gas: 5803)
Suite result: ok. 21 passed; 0 failed; 0 skipped; finished in 9.52ms (14.21ms CPU time)

Ran 22 tests for test/EarlySellPenaltyHookTest.sol:EarlySellPenaltyHookTest
[PASS] test_BlockTimestampEdgeCases_ShouldFail() (gas: 390294)
[PASS] test_BuyerTimestampRecordedEventEmitted_ShouldFail() (gas: 341521)
[PASS] test_BuyerTimestampRecordedOnPurchase_ShouldFail() (gas: 341010)
[PASS] test_CustomPenaltyRateWorks_ShouldFail() (gas: 410890)
[PASS] test_DifferentBuyersHaveDifferentTimestamps_ShouldFail() (gas: 424085)
[PASS] test_EarlySellPenaltyHookContractDoesNotExist_ShouldFail() (gas: 3719)
[PASS] test_FirstTimeBuyerHasZeroTimestamp() (gas: 10076)
[PASS] test_FirstTimeSellWithoutBuyHasMaxPenalty_ShouldFail() (gas: 400657)
[PASS] test_IEarlySellPenaltyHookInterfaceCompilation_ShouldFail() (gas: 8132)
[PASS] test_ImmediateSellHasMaximumPenalty_ShouldFail() (gas: 390803)
[PASS] test_MultipleBuysSingleSell_ShouldFail() (gas: 420261)
[PASS] test_NoPenaltyAfter100Hours_ShouldFail() (gas: 367866)
[PASS] test_PenaltyAppliedEventEmitted_ShouldFail() (gas: 403975)
[PASS] test_PenaltyAtExactHourBoundaries_ShouldFail() (gas: 402743)
[PASS] test_PenaltyCanBeDeactivated_ShouldFail() (gas: 369271)
[PASS] test_PenaltyDeclinesOverTime_ShouldFail() (gas: 402746)
[PASS] test_PenaltyHookIntegratesWithBehodler3_ShouldFail() (gas: 393084)
[PASS] test_PenaltyParametersCanBeSet() (gas: 20401)
[PASS] test_PenaltyParametersUpdatedEventEmitted_ShouldFail() (gas: 21186)
[PASS] test_TimestampStorageGasCosts() (gas: 339755)
[PASS] test_TimestampUpdatedOnSubsequentBuy_ShouldFail() (gas: 371386)
[PASS] test_ZeroAmountBuyDoesNotUpdateTimestamp_ShouldFail() (gas: 55981)
Suite result: ok. 22 passed; 0 failed; 0 skipped; finished in 9.57ms (8.19ms CPU time)

Ran 36 tests for test/B3BuySellHooksTest.sol:B3BuySellHooksTest
[PASS] test_BuyHookCalledDuringAddLiquidity_ShouldFail() (gas: 324080)
[PASS] test_BuyHookCallsAfterBaseCalculation_ShouldFail() (gas: 325293)
[PASS] test_BuyHookFeeAppliedToInputToken_ShouldFail() (gas: 323682)
[PASS] test_BuyHookReceivesCorrectBaseBondingAmount_ShouldFail() (gas: 325294)
[PASS] test_BuyHookReceivesCorrectBaseInputAmount_ShouldFail() (gas: 323153)
[PASS] test_BuyHookReceivesCorrectBuyerAddress_ShouldFail() (gas: 323419)
[PASS] test_BuyOperationSkipsHookWhenAddressIsZero_ShouldFail() (gas: 190874)
[PASS] test_BuyRevertsWhenNegativeDeltaExceedsBaseMinting_ShouldFail() (gas: 163576)
[PASS] test_BuyWithPositiveDeltaBondingTokenBonus_ShouldFail() (gas: 322669)
[PASS] test_CompleteBuyFlow_ShouldFail() (gas: 327017)
[PASS] test_CompleteSellFlow_ShouldFail() (gas: 373435)
[PASS] test_DeltaBondingTokenAdjustmentEventsEmitted_ShouldFail() (gas: 323229)
[PASS] test_EdgeCaseDeltaEqualsNegativeBaseAmount_ShouldFail() (gas: 163545)
[PASS] test_FeeApplicationEventsEmitted_ShouldFail() (gas: 324857)
[PASS] test_FeeCalculationWithMaximumFee_ShouldFail() (gas: 164809)
[PASS] test_FeeCalculationWithTypicalFee_ShouldFail() (gas: 321531)
[PASS] test_FeeCalculationWithZeroFee_ShouldFail() (gas: 317897)
[PASS] test_HookAddressRetrieval_ShouldFail() (gas: 10831)
[PASS] test_HookAddressStorage_ShouldFail() (gas: 10265)
[PASS] test_HookCallEventsEmitted_ShouldFail() (gas: 327089)
[PASS] test_NegativeDeltaBondingTokenDecreasesMintedTokensOnBuy_ShouldFail() (gas: 322725)
[PASS] test_NegativeDeltaBondingTokenDecreasesRequiredTokensOnSell_ShouldFail() (gas: 315277)
[PASS] test_NoRevertWithUnsetHooksDuringNormalOperations_ShouldFail() (gas: 201310)
[PASS] test_PositiveDeltaBondingTokenIncreasesMintedTokensOnBuy_ShouldFail() (gas: 319900)
[PASS] test_PositiveDeltaBondingTokenIncreasesRequiredTokensOnSell_ShouldFail() (gas: 365598)
[PASS] test_SellHookCalledDuringRemoveLiquidity_ShouldFail() (gas: 367802)
[PASS] test_SellHookCallsAfterBaseCalculation_ShouldFail() (gas: 368896)
[PASS] test_SellHookFeeAppliedToBondingToken_ShouldFail() (gas: 366492)
[PASS] test_SellHookReceivesCorrectBaseBondingAmount_ShouldFail() (gas: 366716)
[PASS] test_SellHookReceivesCorrectBaseInputAmount_ShouldFail() (gas: 368919)
[PASS] test_SellHookReceivesCorrectSellerAddress_ShouldFail() (gas: 367047)
[PASS] test_SellOperationSkipsHookWhenAddressIsZero_ShouldFail() (gas: 202907)
[PASS] test_SellRevertsWhenAdjustmentsResultInZeroOrNegative_ShouldFail() (gas: 325643)
[PASS] test_SellWithNegativeDeltaBondingTokenDiscount_ShouldFail() (gas: 368442)
[PASS] test_SetHook_OnlyOwner_ShouldFail() (gas: 37747)
[PASS] test_UnauthorizedSetHook_ShouldFail() (gas: 15347)
Suite result: ok. 36 passed; 0 failed; 0 skipped; finished in 9.58ms (12.13ms CPU time)

Ran 17 tests for test/VirtualLiquidityTest.sol:VirtualLiquidityTest
[PASS] test_AddLiquidity_WithVirtualLiquidity() (gas: 495593)
[PASS] test_AveragePrice_CalculatedCorrectly() (gas: 493627)
[PASS] test_CurrentMarginalPrice_StartsAtInitialPrice() (gas: 197432)
[PASS] test_EdgeCase_ApproachingFundingGoal() (gas: 492290)
[PASS] test_EdgeCase_VerySmallAmounts() (gas: 490278)
[PASS] test_ExampleParameters_XFin1M_X01K_PAve09() (gas: 199200)
[PASS] test_FinalMarginalPrice_IsOne() (gas: 5710)
[PASS] test_HoldersCannot_ClaimMoreThanAvailable() (gas: 496268)
[PASS] test_InitialMarginalPrice_EqualsSquareOfAveragePrice() (gas: 197365)
[PASS] test_MathematicalInvariant_Holds() (gas: 496574)
[PASS] test_PriceBounds_AreEnforced() (gas: 197704)
[PASS] test_RemoveLiquidity_WithVirtualLiquidity() (gas: 548400)
[PASS] test_SetGoals_CalculatesCorrectParameters() (gas: 202153)
[PASS] test_SetGoals_InputValidation() (gas: 24548)
[PASS] test_TotalRaised_CalculatedCorrectly() (gas: 492539)
[PASS] test_VirtualLiquidityAlwaysEnabled() (gas: 198329)
[PASS] test_VirtualLiquidityQuote_ReturnsReasonableValues() (gas: 196529)
Suite result: ok. 17 passed; 0 failed; 0 skipped; finished in 9.44ms (10.21ms CPU time)

Ran 11 test suites in 65.24ms (89.57ms CPU time): 230 tests passed, 0 failed, 2 skipped (232 total tests)
